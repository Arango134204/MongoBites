{% extends "base.html" %}

{% block title %}
  {% if modo == "crear" %}Nuevo producto - MongoBites{% else %}Editar producto - MongoBites{% endif %}
{% endblock %}

{% block content %}
<div class="container">
  <h1 class="h4 mb-4">
    {% if modo == "crear" %}
      ➕ Nuevo producto
    {% else %}
      ✏️ Editar producto
    {% endif %}
  </h1>

 <form
  action="{% if modo=='editar' %}{{ url_for('productos_actualizar', id=producto._id|string) }}{% else %}{{ url_for('productos_crear') }}{% endif %}"
  method="POST"
  class="row g-3"
  enctype="multipart/form-data"
>

    <div class="col-md-6">
      <label class="form-label">Nombre</label>
      <input type="text" name="nombre" class="form-control" required
             value="{{ producto.nombre if producto else '' }}">
    </div>

    <div class="col-md-6">
      <label class="form-label">Categoría</label>
      <input type="text" name="categoria" class="form-control"
             value="{{ producto.categoria if producto else '' }}">
    </div>

    <div class="col-md-4">
      <label class="form-label">Precio</label>
      <input type="number" step="0.01" min="0" name="precio" class="form-control"
             value="{{ producto.precio if producto else '' }}">
    </div>

    <div class="col-md-4">
      <label class="form-label">Stock</label>
      <input type="number" min="0" name="stock" class="form-control"
             value="{{ producto.stock if producto else '' }}">
    </div>

    <div class="col-md-4 d-flex align-items-end">
      <div class="form-check">
        <input class="form-check-input" type="checkbox" id="activo" name="activo"
               {% if producto and producto.activo %}checked{% elif modo=='crear' %}checked{% endif %}>
        <label class="form-check-label" for="activo">Activo</label>
      </div>
    </div>

    <div class="col-md-6">
  <label class="form-label">Imagen del producto</label>
  <input type="file" name="imagen" accept="image/*" class="form-control">

  {% if producto and producto._id and producto.image_data %}
    <img src="{{ url_for('producto_imagen', id=producto._id|string) }}"
         class="img-thumbnail mt-2" style="height:120px;">
  {% endif %}
</div>

    <div class="col-12">
      <a href="{{ url_for('productos_list') }}" class="btn btn-outline-secondary">⬅ Volver</a>
      <button class="btn btn-primary">
        {{ 'Actualizar' if modo=='editar' else 'Crear' }}
      </button>
    </div>

  </form>
</div>
{% endblock %}
